angular.module("jsPassword").service("EntriesCollection",["$rootScope","Fixtures",function(t,e){var n=this;this.size=function(){return storedb("EntriesCollection").find().length},this.at=function(t){return storedb("EntriesCollection").find()[t]},this.getAllEntriesGrouped=function(){return _.groupBy(storedb("EntriesCollection").find(),function(t){return t.data.Name.value.charAt(0).toLowerCase()})},this.getFavoriteEntriesGrouped=function(){var t=_.groupBy(storedb("EntriesCollection").find(),function(t){return t.data.Name.value.charAt(0).toLowerCase()}),e={};return _.each(t,function(t,n){_.each(t,function(t){t.data.Favorite.value&&(_.has(e,n)||(e[n]=[]),e[n].push(t))})}),e},this.nextId=function(){var t=0;if(storedb("EntriesCollection").find().length){var e=_.last(storedb("EntriesCollection").find()).id;"number"==typeof e&&(t=e+1)}return t},this.prepareNew=function(){var t=0;if(storedb("EntriesCollection").find().length){var e=_.last(storedb("EntriesCollection").find()).id;"number"==typeof e&&(t=e+1)}return{id:t,data:{Name:{value:"",type:"string"},Password:{value:"",type:"password"},Favorite:{value:!1,type:"boolean"},Website:{value:"",type:"string"},Note:{value:"",type:"text"}}}},this["new"]=function(e){storedb("EntriesCollection").insert(e),t.$broadcast("EntriesCollection::changed")},this.update=function(e,n){storedb("EntriesCollection").update({id:parseInt(e)},{$set:{data:n}}),t.$broadcast("EntriesCollection::changed")},this.destroy=function(e){storedb("EntriesCollection").remove({id:parseInt(e)}),t.$broadcast("EntriesCollection::changed")},this.find=function(t){var e={},n=this.getAllEntriesGrouped();return _.each(n,function(n,i){_.each(n,function(n){return n.id==t?e=n:void 0}),e}),e.data},this.reset=function(){storedb("EntriesCollection").remove(),_.each(e.EntriesCollection,function(t){storedb("EntriesCollection").insert(t)})}}]);